{% extends "layout.html" %}
{% block head %}
{{ super() }}
<link href="{{ url_for('static', filename='kindeditor/themes/default/default.css') }}" rel="stylesheet">
<script src="{{ url_for('static', filename='kindeditor/kindeditor-all-min.js') }}"></script>
<script src="{{ url_for('static', filename='kindeditor/lang/en.js') }}"></script>
<style>
#comments-modal .modal-body {
    width: 100%; 
    height: 200px;
}
</style>
<script>
$(document).ready(function(){
    $('#comments-modal').on('shown.bs.modal', function () {
        $(document).off('focusin.modal');
        KindEditor.create('textarea[name="comments"]', {
            resizeType : 1,
            allowPreviewEmoticons : false,
            allowImageUpload : false,
            items : [
                'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold', 'italic', 'underline',
                'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',
                'insertunorderedlist', '|', 'link'],
            width: '100%',
            autoHeightMode : true,
            afterCreate : function() {
                this.loadPlugin('autoheight');
            }
        });
        KindEditor.html('textarea[name="comments"]', $(this).attr('data-comments'));
    })

    $('#comments-modal').on('hidden.bs.modal', function () {
        KindEditor.remove('textarea[name="comments"]');
    })

    $(".comments").dblclick(function(){
        var primary_key = $(this).parent().find('td').first().text();
        var comments = $(this).parent().find('td').last().text();
        $('#comments-modal').attr('data-comments', comments);
        $('#comments-modal').attr('data-primary_key', primary_key);
        $('#comments-modal').modal('show');
    });

});
</script>
{% endblock %}

{% block content %}
{{ super() }}
<div class="modal fade" id="comments-modal" tabindex="-1" role="dialog" 
                                                          aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" 
                                      data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    Edit Comments
                </h4>
            </div>
        <textarea name='comments' class="modal-body"></textarea>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" 
                                      data-dismiss="modal">close
                </button>
                <button type="button" class="btn btn-primary">
                    submit
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
{% endblock %}
